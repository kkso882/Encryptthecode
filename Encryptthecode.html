<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lua Obfuscator & Deobfuscator</title>
<style>
  body { background:#1e1e1e; color:#eee; font-family: monospace; display:flex; flex-direction:column; align-items:center; padding:20px;}
  textarea { width:90%; height:150px; margin:10px 0; background:#2e2e2e; color:#eee; border:none; padding:10px; resize:none;}
  button { padding:10px 20px; margin:5px; background:#444; color:#eee; border:none; cursor:pointer;}
  button:hover { background:#555; }
  h1 { font-size:24px; }
</style>
</head>
<body>
<h1>Lua Obfuscator & Deobfuscator</h1>

<textarea id="input" placeholder="วาง Lua script หรือข้อความตรงนี้"></textarea>
<div>
  <button onclick="obfuscate()">Obfuscate</button>
  <button onclick="deobfuscate()">Deobfuscate</button>
</div>
<textarea id="output" placeholder="ผลลัพธ์จะปรากฏที่นี่"></textarea>

<script>
function obfuscate() {
    let code = document.getElementById('input').value;
    if(!code) return alert("ใส่สคริปก่อนครับ!");
    
    // ขั้นตอนเข้ารหัสแบบง่ายแต่สับสน
    let result = code.split('').map(c => {
        return '\\x'+c.charCodeAt(0).toString(16);
    }).join('');

    // เพิ่ม wrapper Lua สำหรับ decode กลับ
    let luaObf = `loadstring((function(s)local r="" for i=1,#s,4 do r=r..string.char(tonumber(s:sub(i,i+3),16)) end return r end)("${result}"))()`;
    document.getElementById('output').value = luaObf;
}

function deobfuscate() {
    let code = document.getElementById('input').value;
    if(!code) return alert("ใส่สคริปก่อนครับ!");
    
    // ตรวจสอบ pattern ของ Obfuscator ด้านบน
    let match = code.match(/"\(function.*\)\("([^"]*)"\)\)\(\)/s);
    if(match && match[1]){
        let hexStr = match[1];
        let text = '';
        for(let i=0;i<hexStr.length;i+=4){
            text += String.fromCharCode(parseInt(hexStr.substr(i,4),16));
        }
        document.getElementById('output').value = text;
    } else {
        alert("ไม่พบสคริปต์ที่เข้ารหัสแบบนี้ครับ!");
    }
}
</script>
</body>
</html>
